import references
import pandas as pd


MANUALLY_CURATED = {
    'A2BP1': 'ENSG00000078328',
    'ACCN4': 'ENSG00000072182',
    'ACN9': 'ENSG00000196636',
    'AIM1L': 'ENSG00000176092',
    'ALS2CR4': 'ENSG00000155755',
    'ARPP-21': 'ENSG00000172995',
    'ASAM': 'ENSG00000166250',
    'BAI1': 'ENSG00000181790',
    'C10orf11': 'ENSG00000148655',
    'C10orf26': 'ENSG00000166272',
    'C10orf41': 'ENSG00000237149',
    'C11orf20': 'ENSG00000219435',
    'C11orf66': 'ENSG00000162148',
    'C11orf85': 'ENSG00000168070',
    'C13orf15': 'ENSG00000102760',
    'C13orf33': 'ENSG00000102802',
    'C14orf106': 'ENSG00000129534',
    'C14orf162': 'ENSG00000267909',
    'C14orf43': 'ENSG00000156030',
    'C14orf50': 'ENSG00000165807',
    'C14orf80': 'ENSG00000185347',
    'C14orf86': 'ENSG00000258584',
    'C16orf73': 'ENSG00000162039',
    'C17orf104': 'ENSG00000180336',
    'C17orf93': 'ENSG00000229637',
    'C18orf42': 'ENSG00000231824',
    'C19orf21': 'ENSG00000099812',
    'C19orf23': 'ENSG00000267493',
    'C19orf55': 'ENSG00000167595',
    'C19orf76': 'ENSG00000224420',
    'C1orf103': 'ENSG00000121931',
    'C1orf104': 'ENSG00000225855',
    'C1orf113': 'ENSG00000214193',
    'C1orf130': 'ENSG00000184454',
    'C1orf150': 'ENSG00000169224',
    'C1orf170': 'ENSG00000187642',
    'C1orf51': 'ENSG00000159208',
    'C1orf59': 'ENSG00000162639',
    'C1orf85': 'ENSG00000198715',
    'C20orf151': 'ENSG00000130701',
    'C20orf199': 'ENSG00000177410',
    'C20orf95': 'ENSG00000124143',
    'C21orf70': 'ENSG00000160256',
    'C22orf26': 'ENSG00000182257',
    'C22orf9': 'ENSG00000100364',
    'C2orf65': 'ENSG00000159374',
    'C3orf59': 'ENSG00000180611',
    'C4orf32': 'ENSG00000174749',
    'C5orf35': 'ENSG00000155542',
    'C6orf103': 'ENSG00000118492',
    'C6orf186': 'ENSG00000053328',
    'C6orf227': 'ENSG00000197251',
    'C6orf41': 'ENSG00000224843',
    'C7orf13': 'ENSG00000182648',
    'C7orf40': 'ENSG00000232956',
    'C7orf51': 'ENSG00000166924',
    'C7orf62': 'ENSG00000164645',
    'C8orf22': 'ENSG00000168333',
    'C8orf55': 'ENSG00000130193',
    'C8orf85': 'ENSG00000205002',
    'C9orf4': 'ENSG00000260230',
    'C9orf98': 'ENSG00000165695',
    'CARKD': 'ENSG00000213995',
    'CCDC108': 'ENSG00000181378',
    'CCDC19': 'ENSG00000213085',
    'CD97': 'ENSG00000123146',
    'CECR1': 'ENSG00000093072',
    'CES8': 'ENSG00000172824',
    'CLRN1OS': 'ENSG00000239265',
    'CSDAP1': 'ENSG00000261614',
    'CUGBP1': 'ENSG00000149187',
    'CXCR7': 'ENSG00000144476',
    'D4S234E': 'ENSG00000168824',
    'DARC': 'ENSG00000213088',
    'DEM1': 'ENSG00000164002',
    'DKFZp686O24166': 'ENSG00000188211',
    'DKFZp761E198': 'ENSG00000254470',
    'DSCR6': 'ENSG00000183145',
    'EFCAB4B': 'ENSG00000130038',
    'EIF2C2': 'ENSG00000123908',
    'ELTD1': 'ENSG00000162618',
    'EMID2': 'ENSG00000160963',
    'FAIM3': 'ENSG00000162894',
    'FAM150A': 'ENSG00000196711',
    'FAM150B': 'ENSG00000189292',
    'FAM176B': 'ENSG00000142694',
    'FAM190A': 'ENSG00000184305',
    'FAM38B': 'ENSG00000154864',
    'FAM59B': 'ENSG00000157833',
    'FAM63A': 'ENSG00000143409',
    'FLJ20184': 'ENSG00000236699',
    'FLJ40125': 'ENSG00000213889',
    'FLJ41350': 'ENSG00000227128',
    'FLJ42875': 'ENSG00000177133',
    'GAREML': 'ENSG00000157833',
    'GNASAS': 'ENSG00000235590',
    'GPR123': 'ENSG00000197177',
    'GPR133': 'ENSG00000111452',
    'GPR172B': 'ENSG00000132517',
    'HOXA11AS': 'ENSG00000240990',
    'HRNBP3': 'ENSG00000167281',
    'IL1F6': 'ENSG00000136694',
    'KIAA0284': 'ENSG00000099814',
    'KIAA0748': 'ENSG00000135426',
    'KIAA1026': 'ENSG00000189337',
    'KIAA1529': 'ENSG00000197816',
    'KIAA1908': 'ENSG00000230487',
    'KLKBL4': 'ENSG00000103023',
    'LACAT8': 'ENSG00000256151',
    'LBXCOR1': 'ENSG00000188779',
    'LDOC1L': 'ENSG00000188636',
    'LECT1': 'ENSG00000136110',
    'LEPREL1': 'ENSG00000090530',
    'LIN28': 'ENSG00000131914',
    'LINC00577': 'ENSG00000203809',
    'LINC00925': 'ENSG00000255571',
    'LOC150622': 'ENSG00000232044',
    'MAP1D': 'ENSG00000172878',
    'MGC26647': 'ENSG00000164645',
    'MIR1259': 'ENSG00000212304',
    'MIR323': 'ENSG00000199069',
    'MIR453': 'ENSG00000208004',
    'MIR663': 'ENSG00000284419',
    'MSL3L2': 'ENSG00000224287',
    'MTL5': 'ENSG00000132749',
    'NAPRT1': 'ENSG00000147813',
    'NBLA00301': 'ENSG00000237125',
    'NCRNA00028': 'ENSG00000233354',
    'NCRNA00092': 'ENSG00000225194',
    'NCRNA00171': 'ENSG00000204623',
    'NELF': 'ENSG00000165802',
    'NHEDC1': 'ENSG00000164037',
    'NUDT16P': 'ENSG00000246082',
    'OTX2OS1': 'ENSG00000248550',
    'PAK7': 'ENSG00000101349',
    'PCDHB18': 'ENSG00000146001',
    'PLAC2': 'ENSG00000223573',
    'PLEC1': 'ENSG00000178209',
    'PRAC': 'ENSG00000159182',
    'PRKCDBP': 'ENSG00000170955',
    'PRUNE': 'ENSG00000143363',
    'ProSAPiP1': 'ENSG00000088899',
    'RICH2': 'ENSG00000006740',
    'RNU5D': 'ENSG00000200169',
    'RNU5E': 'ENSG00000199347',
    'SDPR': 'ENSG00000168497',
    'SDR16C6': 'ENSG00000253542',
    'SIGLECP3': 'ENSG00000171101',
    'SOX2OT': 'ENSG00000242808',
    'WBSCR17': 'ENSG00000185274',
    'WDR52': 'ENSG00000206530',
    'WIT1': 'ENSG00000183242',
    'ZNF285A': 'ENSG00000267508',
    'ZNF389': 'ENSG00000226314',
    'ZNF642': 'ENSG00000187815',
    'ZNF815': 'ENSG00000235944',
    'ZNF833': 'ENSG00000267343',
    'ZSCAN12L1': 'ENSG00000219891',
    'ODZ3': 'ENSG00000218336',
    'HCCA2': 'ENSG00000182208',
}

UNRELIABLE = [
    'RNU5D',
    'RNU5E'
]


def gene_to_ens(genes):
    """
    Convert gene(s) found in the annotation to Ensembl gene IDs
    :param genes: One or more gene names
    :return: pd.Series indexed by genes containing corresponding ENS IDs where available
    """
    if isinstance(genes, str):
        genes = [genes]
    df = references.gene_symbol_to_ensembl(genes)
    not_found = df.index[df.isna()]
    for nf in not_found:
        if nf in MANUALLY_CURATED:
            df.loc[nf] = MANUALLY_CURATED[nf]
    for g in UNRELIABLE:
        if g in df:
            df.loc[g] = None

    return df


